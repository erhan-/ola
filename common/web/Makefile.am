include $(top_srcdir)/common.mk

dist_noinst_DATA = testdata/allof.test \
                   testdata/anyof.test \
                   testdata/arrays.test \
                   testdata/basic-keywords.test \
                   testdata/definitions.test \
                   testdata/integers.test \
                   testdata/misc.test \
                   testdata/not.test \
                   testdata/objects.test \
                   testdata/oneof.test \
                   testdata/schema.json \
                   testdata/strings.test \
                   testdata/type.test

# LIBRARIES
################################################
noinst_LTLIBRARIES = libolaweb.la
libolaweb_la_SOURCES = Json.cpp JsonLexer.cpp JsonParser.cpp JsonPatch.cpp \
                       JsonPatchParser.cpp JsonPointer.cpp JsonSchema.cpp \
                       JsonSections.cpp JsonTypes.cpp JsonWriter.cpp \
                       OptionalItem.h PointerTracker.cpp PointerTracker.h \
                       SchemaErrorLogger.cpp SchemaErrorLogger.h \
                       SchemaKeywords.cpp SchemaKeywords.h \
                       SchemaParseContext.cpp SchemaParseContext.h \
                       SchemaParser.cpp SchemaParser.h

# TESTS
################################################
if BUILD_TESTS
TESTS = JsonParserTester JsonPatchTester JsonPatchParserTester \
        JsonPointerTester JsonSchemaTester \
        JsonSchemaParserTester PointerTrackerTester WebTester
endif
check_PROGRAMS = $(TESTS)

WebTester_SOURCES = JsonTest.cpp JsonSectionsTest.cpp
WebTester_CXXFLAGS = $(COMMON_TESTING_FLAGS)
WebTester_LDADD = $(COMMON_TESTING_LIBS) \
                  ./libolaweb.la \
                  ../base/libolabase.la \
                  ../utils/libolautils.la

JsonParserTester_SOURCES = JsonParserTest.cpp
JsonParserTester_CXXFLAGS = $(COMMON_TESTING_FLAGS)
JsonParserTester_LDADD = $(COMMON_TESTING_LIBS) \
                         ./libolaweb.la \
                         ../base/libolabase.la \
                         ../utils/libolautils.la

JsonSchemaTester_SOURCES = JsonSchemaTest.cpp
JsonSchemaTester_CXXFLAGS = $(COMMON_TESTING_FLAGS)
JsonSchemaTester_LDADD = $(COMMON_TESTING_LIBS) \
                         ./libolaweb.la \
                         ../base/libolabase.la \
                         ../utils/libolautils.la

JsonPointerTester_SOURCES = JsonPointerTest.cpp
JsonPointerTester_CXXFLAGS = $(COMMON_TESTING_FLAGS)
JsonPointerTester_LDADD = $(COMMON_TESTING_LIBS) \
                         ./libolaweb.la \
                         ../base/libolabase.la \
                         ../utils/libolautils.la

JsonPatchTester_SOURCES = JsonPatchTest.cpp
JsonPatchTester_CXXFLAGS = $(COMMON_TESTING_FLAGS)
JsonPatchTester_LDADD = $(COMMON_TESTING_LIBS) \
                        ./libolaweb.la \
                        ../base/libolabase.la \
                        ../utils/libolautils.la

JsonPatchParserTester_SOURCES = JsonPatchParserTest.cpp
JsonPatchParserTester_CXXFLAGS = $(COMMON_TESTING_FLAGS)
JsonPatchParserTester_LDADD = $(COMMON_TESTING_LIBS) \
                              ./libolaweb.la \
                              ../base/libolabase.la \
                              ../utils/libolautils.la

JsonSchemaParserTester_SOURCES = JsonSchemaParserTest.cpp
JsonSchemaParserTester_CXXFLAGS = $(COMMON_TESTING_FLAGS)
JsonSchemaParserTester_LDADD = $(COMMON_TESTING_LIBS) \
                               ./libolaweb.la \
                               ../base/libolabase.la \
                               ../file/libolafile.la \
                               ../utils/libolautils.la

PointerTrackerTester_SOURCES = PointerTrackerTest.cpp
PointerTrackerTester_CXXFLAGS = $(COMMON_TESTING_FLAGS)
PointerTrackerTester_LDADD = $(COMMON_TESTING_LIBS) \
                             ./libolaweb.la \
                             ../base/libolabase.la \
                             ../utils/libolautils.la
