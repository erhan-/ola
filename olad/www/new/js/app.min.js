angular.module("olaApp",["ngRoute"]).constant("OLA",{MIN_CHANNEL_NUMBER:1,MAX_CHANNEL_NUMBER:512,MIN_CHANNEL_VALUE:0,MAX_CHANNEL_VALUE:255}).factory("$ola",["$http","$window","OLA",function(a,b,c){"use strict";var d=function(a){var b=[];for(var c in a)b.push("d"==c?c+"="+a[c]:c+"="+encodeURIComponent(a[c]));return b.join("&")},e=function(a){for(var b=1,d=[],e=0;e<c.MAX_CHANNEL_NUMBER;e++)d[e]=parseInt(a[e],10),d[e]>c.MIN_CHANNEL_VALUE&&(b=e+1);return d.length=b,d.join(",")};return{get:{ItemList:function(){return a.get("/json/universe_plugin_list").then(function(a){return a.data})},ServerInfo:function(){return a.get("/json/server_stats").then(function(a){return a.data})},Ports:function(){return a.get("/json/get_ports").then(function(a){return a.data})},PortsId:function(b){return a.get("/json/get_ports?u="+b).then(function(a){return a.data})},InfoPlugin:function(b){return a.get("/json/plugin_info?id="+b).then(function(a){return a.data})},Dmx:function(b){return a.get("/get_dmx?u="+b).then(function(a){return a.data})},UniverseInfo:function(b){return a.get("/json/universe_info?id="+b).then(function(a){return a.data})}},post:{ModifyUniverse:function(b){return a({method:"POST",url:"/modify_universe",data:d(b),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return a.data})},AddUniverse:function(b){return a({method:"POST",url:"/new_universe",data:d(b),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return a.data})},Dmx:function(b,c){var f={u:b,d:e(c)};return a({method:"POST",url:"/set_dmx",data:d(f),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return a.data})}},action:{Shutdown:function(){return a.get("/quit").then(function(a){return a.data})},Reload:function(){return a.get("/reload").then(function(a){return a.data})},ReloadPids:function(){return a.get("/reload_pids").then(function(a){return a.data})}},rdm:{},tabs:function(a,c){b.$("ul#ola-nav-tabs").html('<li id="overview" role="presentation"><a href="/new/#/universe/'+c+'/">Overview</a></li><li id="faders" role="presentation"><a href="/new/#/universe/'+c+'/faders">Faders</a></li><li id="keypad" role="presentation"><a href="/new/#/universe/'+c+'/keypad">Keypad</a></li><li id="rdm" role="presentation"><a href="/new/#/universe/'+c+'/rdm">RDM</a></li><li id="patch" role="presentation"><a href="/new/#/universe/'+c+'/patch">RDM Patcher</a></li><li id="settings"role="presentation"><a href="/new/#/universe/'+c+'/settings">Settings</a></li>'),b.$("ul#ola-nav-tabs > li#"+a).addClass("active")}}}]).controller("menuCtrl",["$scope","$ola","$interval",function(a,b,c){"use strict";a.Items={},a.Info={},b.get.ItemList().then(function(b){a.Items=b}),b.get.ServerInfo().then(function(b){a.Info=b}),c(function(){b.get.ItemList().then(function(b){a.Items=b}),b.get.ServerInfo().then(function(b){a.Info=b})},1e4)}]).controller("overviewCtrl",["$scope","$ola","$location",function(a,b,c){"use strict";a.Info={},a.Universes={},b.get.ItemList().then(function(b){a.Universes=b.universes}),b.get.ServerInfo().then(function(b){a.Info=b}),a.Shutdown=function(){b.action.Shutdown().then(function(){})},a.goUniverse=function(a){c.path("/universe/"+a)}}]).controller("addUniverseCtrl",["$scope","$ola","$window","$location",function(a,b,c,d){"use strict";a.Ports={},a.addPorts=[],a.Universes=[],a.buttonState=!0,a.Class="",a.Data={id:0,name:"",add_ports:""},a.$watchCollection("Data",function(){return-1!==a.Universes.indexOf(a.Data.id)||""===a.Data.name||""===a.Data.add_ports?void(a.buttonState=!0):null===a.Data.id||null===a.Data.name||null===a.Data.add_ports?void(a.buttonState=!0):"number"!=typeof a.Data.id||"string"!=typeof a.Data.name||"string"!=typeof a.Data.add_ports?void(a.buttonState=!0):void(a.buttonState=!1)}),b.get.ItemList().then(function(b){for(var c in b.universes)a.Data.id===parseInt(b.universes[c].id,10)&&a.Data.id++,a.Universes.push(parseInt(b.universes[c].id,10))}),a.Submit=function(){b.post.AddUniverse(a.Data),d.path("/universe/"+a.Data.id)},b.get.Ports().then(function(b){a.Ports=b}),a.Direction=function(a){return a?"Output":"Input"},a.updateId=function(){a.Class=-1!==a.Universes.indexOf(a.Data.id)?"has-error":""},a.TogglePort=function(){a.Data.add_ports=c.$.grep(a.addPorts,Boolean).join(",")}}]).controller("universeCtrl",["$scope","$ola","$routeParams","$interval","OLA",function(a,b,c,d,e){"use strict";b.tabs("overview",c.id),a.dmx=[],a.Universe=c.id;var f=d(function(){b.get.Dmx(a.Universe).then(function(b){for(var c=0;c<e.MAX_CHANNEL_NUMBER;c++)a.dmx[c]="number"==typeof b.dmx[c]?b.dmx[c]:e.MIN_CHANNEL_VALUE})},100);a.$on("$destroy",function(){d.cancel(f)}),a.getColor=function(a){return a>140?"black":"white"}}]).controller("faderUniverseCtrl",["$scope","$ola","$routeParams","$window","$interval","OLA",function(a,b,c,d,e,f){"use strict";b.tabs("faders",c.id),a.get=[],a.list=[],a.last=0,a.offset=0,a.send=!1,a.OLA=f,a.Universe=c.id;for(var g=0;g<f.MAX_CHANNEL_NUMBER;g++)a.list[g]=g,a.get[g]=f.MIN_CHANNEL_VALUE;a.light=function(b){for(var c=0;c<f.MAX_CHANNEL_NUMBER;c++)a.get[c]=b;a.change()};var h=e(function(){b.get.Dmx(a.Universe).then(function(b){for(var c=0;c<b.dmx.length;c++)a.get[c]=b.dmx[c];a.send=!0})},1e3);a.getColor=function(a){return a>140?"black":"white"},a.ceil=function(a){return d.Math.ceil(a)},a.change=function(){b.post.Dmx(a.Universe,a.get)},a.page=function(b){1===b?a.offset+1!==d.Math.ceil(f.MAX_CHANNEL_NUMBER/a.limit)&&a.offset++:b===f.MIN_CHANNEL_VALUE&&a.offset!==f.MIN_CHANNEL_VALUE&&a.offset--},a.limit=d.Math.floor(.99*d.innerWidth/66),a.width={width:d.Math.floor(.99*d.innerWidth/a.limit)-52/a.limit+"px"},d.$(d).resize(function(){a.$apply(function(){a.limit=d.Math.floor(.99*d.innerWidth/66),a.width={width:d.Math.floor(.99*d.innerWidth/a.limit)-52/a.limit+"px"}})}),a.$on("$destroy",function(){e.cancel(h)})}]).controller("keypadUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";b.tabs("keypad",c.id),a.Universe=c.id}]).controller("rdmUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";b.tabs("rdm",c.id),a.Universe=c.id}]).controller("patchUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";b.tabs("patch",c.id),a.Universe=c.id}]).controller("settingUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";b.tabs("settings",c.id),a.Universe=c.id,a.Info={},a.PortsId={},a.ActivePorts={},a.Remove=[],a.Data={},b.get.PortsId(c.id).then(function(b){a.PortsId=b}),b.get.UniverseInfo(c.id).then(function(b){a.Info=b,a.ActivePorts=b.output_ports.concat(b.input_ports);for(var c=0;c<a.ActivePorts.length;c++)a.Remove[c]=""})}]).controller("pluginInfoCtrl",["$scope","$routeParams","$ola","$window",function(a,b,c,d){"use strict";c.get.InfoPlugin(b.id).then(function(b){a.active=b.active,a.enabled=b.enabled,a.name=b.name;var c=document.getElementById("description");c.textContent=b.description,c.innerHTML=c.innerHTML.replace(/\\n/g,"<br />"),d.console.log(b)}),a.stateColor=function(a){return a?{"background-color":"green"}:{"background-color":"red"}}}]).controller("pluginsCtrl",["$scope","$ola","$location",function(a,b,c){"use strict";a.Items={},a.active=[],a.enabled=[],b.get.ItemList().then(function(c){a.Items=c,c.plugins.forEach(function(c){b.get.InfoPlugin(c.id).then(function(b){a.getStyleActive(b.active,c.id),a.getStyleEnabled(b.enabled,c.id)})})}),a.go=function(a){c.path("/plugin/"+a)},a.getStyleActive=function(b,c){a.active[c]=b?{"background-color":"green"}:{"background-color":"red"}},a.getStyleEnabled=function(b,c){a.enabled[c]=b?{"background-color":"green"}:{"background-color":"red"}}}]).config(["$routeProvider",function(a){"use strict";a.when("/",{templateUrl:"/new/views/overview.html",controller:"overviewCtrl"}).when("/universes/",{templateUrl:"/new/views/universes.html",controller:"overviewCtrl"}).when("/universe/add",{templateUrl:"/new/views/universe-add.html",controller:"addUniverseCtrl"}).when("/universe/:id",{templateUrl:"/new/views/universe-overview.html",controller:"universeCtrl"}).when("/universe/:id/keypad",{templateUrl:"/new/views/universe-keypad.html",controller:"keypadUniverseCtrl"}).when("/universe/:id/faders",{templateUrl:"/new/views/universe-faders.html",controller:"faderUniverseCtrl"}).when("/universe/:id/rdm",{templateUrl:"/new/views/universe-rdm.html",controller:"rdmUniverseCtrl"}).when("/universe/:id/patch",{templateUrl:"/new/views/universe-patch.html",controller:"patchUniverseCtrl"}).when("/universe/:id/settings",{templateUrl:"/new/views/universe-settings.html",controller:"settingUniverseCtrl"}).when("/plugins",{templateUrl:"/new/views/plugins.html",controller:"pluginsCtrl"}).when("/plugin/:id",{templateUrl:"/new/views/plugin-info.html",controller:"pluginInfoCtrl"}).otherwise({redirectTo:"/"})}]).filter("startFrom",function(){"use strict";return function(a,b){return b=parseInt(b),a.slice(b)}});
//# sourceMappingURL=app.min.js.map